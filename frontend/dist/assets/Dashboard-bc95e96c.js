import{u as O,h as d,l as N,k as m,r as A,o as u,c as v,a as s,t as l,d as P,F as V,m as B,j as p,v as f,n as y,p as w,q as I,b as F}from"./index-efdc2911.js";import{_ as R}from"./_plugin-vue_export-helper-c27b6911.js";const U={class:"dashboard"},q={class:"grid"},z={class:"col-12 md:col-6 lg:col-3"},E={class:"card"},L={class:"stat-card"},M={class:"stat-content"},$={class:"stat-value"},j={class:"col-12 md:col-6 lg:col-3"},G={class:"card"},H={class:"stat-card"},J={class:"stat-content"},K={class:"stat-value"},Q={class:"col-12 md:col-6 lg:col-3"},W={class:"card"},X={class:"stat-card"},Y={class:"stat-content"},Z={class:"stat-value"},ss={class:"col-12 md:col-6 lg:col-3"},ts={class:"card"},es={class:"stat-card"},os={class:"stat-content"},as={class:"stat-value"},ls={class:"grid mt-4"},ns={class:"col-12"},is={class:"card"},ds={class:"card-content"},rs={class:"data-table"},cs={class:"font-bold"},us={key:0,class:"modal-overlay"},vs={class:"modal"},_s={class:"modal-content"},ps={class:"field"},gs={key:0,class:"error"},ms={class:"field"},fs={class:"field"},bs={class:"field"},ks={__name:"Dashboard",setup(hs){O();const b=d(!1),_=d(!1),a=d({title:"",description:"",status:"TODO",assigned_to:""}),r=d(!1),c=d({todo:0,inProgress:0,done:0,total:0}),k=d([]),g=()=>{const o=localStorage.getItem("token")||sessionStorage.getItem("token");return o||null};N(async()=>{await Promise.all([h(),T()])});const h=async()=>{var o;console.log("loadStats");try{const t=g();if(!t)return;const i=await m.get("/api/tasks",{headers:{Authorization:`Bearer ${t}`}});console.log(i.data);const e=i.data;c.value={todo:e.filter(n=>n.status==="todo").length,inProgress:e.filter(n=>n.status==="in_progress").length,done:e.filter(n=>n.status==="done").length,total:e.length}}catch(t){console.error("Failed to load task statistics:",t),(o=t.response)==null||o.status}},T=async()=>{var o;b.value=!0;try{const t=g();if(!t)return;const i=await m.get("/api/tasks",{headers:{Authorization:`Bearer ${t}`}});k.value=i.data.sort((e,n)=>new Date(n.createdAt)-new Date(e.createdAt))}catch(t){console.error("Failed to load recent tasks:",t),(o=t.response)==null||o.status}finally{b.value=!1}},S=o=>new Date(o).toLocaleDateString(),x=()=>{a.value={title:"",description:"",status:"TODO",assigned_to:""},r.value=!1,_.value=!0},D=()=>{_.value=!1,r.value=!1},C=async()=>{if(r.value=!0,a.value.title.trim())try{const o=g();if(!o)return;await m.post("/api/tasks",a.value,{headers:{Authorization:`Bearer ${o}`}}),await Promise.all([h(),T()]),_.value=!1,a.value={title:"",description:"",status:"TODO",assigned_to:""}}catch(o){console.error("Failed to save task",o)}};return(o,t)=>{const i=A("Toast");return u(),v("div",U,[t[21]||(t[21]=s("h1",null,"Dashboard",-1)),s("div",q,[s("div",z,[s("div",E,[s("div",L,[t[5]||(t[5]=s("i",{class:"stat-icon todo"},"ðŸ“‹",-1)),s("div",M,[s("span",$,l(c.value.todo),1),t[4]||(t[4]=s("span",{class:"stat-label"},"To Do",-1))])])])]),s("div",j,[s("div",G,[s("div",H,[t[7]||(t[7]=s("i",{class:"stat-icon in-progress"},"â³",-1)),s("div",J,[s("span",K,l(c.value.inProgress),1),t[6]||(t[6]=s("span",{class:"stat-label"},"In Progress",-1))])])])]),s("div",Q,[s("div",W,[s("div",X,[t[9]||(t[9]=s("i",{class:"stat-icon done"},"âœ…",-1)),s("div",Y,[s("span",Z,l(c.value.done),1),t[8]||(t[8]=s("span",{class:"stat-label"},"Completed",-1))])])])]),s("div",ss,[s("div",ts,[s("div",es,[t[11]||(t[11]=s("i",{class:"stat-icon total"},"ðŸ“Š",-1)),s("div",os,[s("span",as,l(c.value.total),1),t[10]||(t[10]=s("span",{class:"stat-label"},"Total Tasks",-1))])])])])]),s("div",ls,[s("div",ns,[s("div",is,[s("div",{class:"card-header"},[s("div",{class:"flex align-items-center justify-content-between"},[t[13]||(t[13]=s("span",null,"Recent Tasks",-1)),s("button",{class:"btn-primary",onClick:x},t[12]||(t[12]=[s("i",{class:"icon-plus"},null,-1),P(" New Task ")]))])]),s("div",ds,[s("table",rs,[t[14]||(t[14]=s("thead",null,[s("tr",null,[s("th",null,"Title"),s("th",null,"Status"),s("th",null,"Assigned To"),s("th",null,"Created")])],-1)),s("tbody",null,[(u(!0),v(V,null,B(k.value,e=>(u(),v("tr",{key:e.id},[s("td",null,[s("span",cs,l(e.title),1)]),s("td",null,[s("span",{class:y(["status-badge",e.status.toLowerCase()])},l(e.status),3)]),s("td",null,l(e.assigned_to||"Unassigned"),1),s("td",null,l(S(e.created_at)),1)]))),128))])])])])])]),_.value?(u(),v("div",us,[s("div",vs,[s("div",{class:"modal-header"},[t[15]||(t[15]=s("h2",null,"New Task",-1)),s("button",{class:"btn-close",onClick:D},"Ã—")]),s("div",_s,[s("div",ps,[t[16]||(t[16]=s("label",{for:"title"},"Title",-1)),p(s("input",{type:"text",id:"title","onUpdate:modelValue":t[0]||(t[0]=e=>a.value.title=e),required:"",class:y({invalid:r.value&&!a.value.title})},null,2),[[f,a.value.title,void 0,{trim:!0}]]),r.value&&!a.value.title?(u(),v("small",gs,"Title is required.")):w("",!0)]),s("div",ms,[t[17]||(t[17]=s("label",{for:"description"},"Description",-1)),p(s("textarea",{id:"description","onUpdate:modelValue":t[1]||(t[1]=e=>a.value.description=e),rows:"3"},null,512),[[f,a.value.description]])]),s("div",fs,[t[19]||(t[19]=s("label",{for:"status"},"Status",-1)),p(s("select",{id:"status","onUpdate:modelValue":t[2]||(t[2]=e=>a.value.status=e),required:""},t[18]||(t[18]=[s("option",{value:"TODO"},"To Do",-1),s("option",{value:"IN_PROGRESS"},"In Progress",-1),s("option",{value:"DONE"},"Done",-1)]),512),[[I,a.value.status]])]),s("div",bs,[t[20]||(t[20]=s("label",{for:"assigned_to"},"Assigned To",-1)),p(s("input",{type:"text",id:"assigned_to","onUpdate:modelValue":t[3]||(t[3]=e=>a.value.assigned_to=e)},null,512),[[f,a.value.assigned_to,void 0,{trim:!0}]])])]),s("div",{class:"modal-footer"},[s("button",{class:"btn-secondary",onClick:D},"Cancel"),s("button",{class:"btn-primary",onClick:C},"Save")])])])):w("",!0),F(i)])}}},ys=R(ks,[["__scopeId","data-v-a277eb66"]]);export{ys as default};
